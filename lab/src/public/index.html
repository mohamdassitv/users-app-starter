<!DOCTYPE html><html><head><meta charset="utf-8"><title>Ops 101 Exam Lab</title>
<link rel="stylesheet" href="/styles.css"></head>
<body><div class="container">
  <div class="card"><h2>Ops 101 Exam Lab</h2>
    <p>Welcome! This portal guides you through a realistic, step-by-step exam. Open each task and follow the instructions. Most tasks have a <strong>Check</strong> button that validates your work.</p>
    <p class="small">Timebox: ~3–5 hours. Use your browser dev tools, <kbd>curl</kbd>, and a text editor.</p>
    <p>Admin API key (for IAM task): <code>admin123</code></p>
    <p>Useful endpoints live here (local): <code>http://localhost:8081</code></p>
  </div>

  <div class="grid">
    <div class="card"><h3>1) HTTP & Latency Basics</h3><p>Gateway with ok/403/502 + delay.</p><p><a href="/task/http.html">Open Task</a></p></div>
    <div class="card"><h3>2) IAM: Unlock Logs</h3><p>Grant yourself <em>LogReader</em> via API, then fetch logs.</p><p><a href="/task/iam.html">Open Task</a></p></div>
    <div class="card"><h3>3) Regex</h3><p>Strict email pattern (.com/.net only).</p><p><a href="/task/regex.html">Open Task</a></p></div>
    <div class="card"><h3>4) Log Analysis</h3><p>Count errors, spot issues, propose a fix.</p><p><a href="/task/logs.html">Open Task</a></p></div>
    <div class="card"><h3>5) Automation</h3><p>Write a small script to measure latency and post results.</p><p><a href="/task/automation.html">Open Task</a></p></div>
    <div class="card"><h3>6) Incident Update</h3><p>Write a blameless customer update with next ETA.</p><p><a href="/task/incident.html">Open Task</a></p></div>
    <div class="card"><h3>7) NAT & Routing (Concept)</h3><p>Pick the correct NAT egress from simple traces.</p><p><a href="/task/nat.html">Open Task</a></p></div>
    <div class="card"><h3>8) Policy & Rollback</h3><p>Block /admin, keep /public accessible.</p><p><a href="/task/policy.html">Open Task</a></p></div>
  </div>

  <div class="card">
    <h3>Progress</h3>
    <p class="small">Green means the built-in checker passed.</p>
    <div id="progress"></div>
  </div>
</div>
<script>
async function refresh(){
  const s = await (await fetch('/api/state')).json();
  const checks = [];
  // Basic derived pass/fail
  checks.push(['IAM LogReader', (s.iam.student.roles||[]).includes('LogReader')]);
  checks.push(['Automation submission', !!s.submissions.health]);
  checks.push(['Regex submitted', !!s.submissions.regex]);
  checks.push(['Incident submitted', !!s.submissions.incident_text]);
  checks.push(['Policy blocks /admin', (s.policy.deny||[]).includes('/admin')]);
  const el = document.getElementById('progress');
  el.innerHTML = checks.map(([name,ok])=>`<div><span class="badge">${ok?'✅':'⬜'}</span> ${name}</div>`).join('');
}
refresh(); setInterval(refresh, 2000);
</script>
</body></html>
